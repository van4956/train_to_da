
Как рассчитать скользящее среднее недели по некоторому amount ?

---

Скользящее среднее можно посчитать через оконную агрегатную функцию `AVG()` с указанием оконного фрейма.

```sql
select
    dt,
    amount,
    avg(amount) over (
        order by dt
        rows between 6 preceding and current row
    ) as avg_7d
from table
```

---

#lvl_3 