
Как получить первое и последнее значение показателя в группе?

---

Используются оконные функции `FIRST_VALUE` и `LAST_VALUE` с `PARTITION BY` и `ORDER BY`. Важно учитывать, что по умолчанию применяется frame `RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW`. Из-за этого `LAST_VALUE` возвращает значение текущей строки, а не последней в группе, поэтому для него обычно явно задают frame `ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING`.

---

#lvl_2 