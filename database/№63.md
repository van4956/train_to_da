
Как получить ARPU в разрезе тарифов?   
Таблица `payments(plan, user_id, amount)`

---

ARPU,  Average Revenue Per User — средняя выручка среди активных пользователей за период.  

```sql
SELECT plan, SUM(amount)::float / NULLIF(COUNT(DISTINCT user_id),0) 
FROM payments 
GROUP BY plan
```

---

#lvl_2 