
Что вернёт запрос, который находит пользователей с подряд идущими 3 днями активности?


```sql
WITH ranked AS (
  SELECT user_id,
         event_date,
         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY event_date) AS rn
  FROM activity
  GROUP BY user_id, event_date
),
groups AS (
  SELECT user_id,
         event_date,
         event_date - rn * INTERVAL '1 day' AS grp_key
  FROM ranked
)
SELECT user_id,
       MIN(event_date) AS streak_start,
       MAX(event_date) AS streak_end,
       COUNT(*) AS days_in_row
FROM groups
GROUP BY user_id, grp_key
HAVING COUNT(*) >= 3;
```

---

Находит всех пользователей с серией минимум из трёх последовательных дней активности и показывает границы серии.

---

#lvl_3 