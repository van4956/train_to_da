
Что вернёт запрос:

```sql
SELECT 
	user_id, 
	COUNT(*) FILTER (WHERE event_name = "signup") AS signups,
    COUNT(*) FILTER (WHERE event_name = "purchase") AS purchases
FROM events
WHERE event_date >= current_date - INTERVAL "30 day"
GROUP BY user_id;
```

---

Для каждого user_id покажет число регистраций и покупок за последние 30 дней, используя условные агрегаты.

---

#lvl_2 