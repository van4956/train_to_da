
Как в SQL посчитать D1 retention с разрезом по типу устройства?

---

Для расчёта D1 retention сначала формируют когорту пользователей по дате первого события (например, `MIN(event_date)` по `user_id`). Затем эти пользователи джойнятся с событиями на следующий день и считается доля пользователей, у которых была активность. Группировка по `device_type` позволяет сравнить retention между платформами.

---

#lvl_2 